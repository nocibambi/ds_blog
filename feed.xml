<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://andrasnovoszath.com/feed.xml" rel="self" type="application/atom+xml" /><link href="https://andrasnovoszath.com/" rel="alternate" type="text/html" /><updated>2020-11-29T02:15:03-06:00</updated><id>https://andrasnovoszath.com/feed.xml</id><title type="html">Value this</title><subtitle>This is not another blog about bitcoin.</subtitle><entry><title type="html">Setting up AWS Cloud for InfluxDB</title><link href="https://andrasnovoszath.com/influxdb/aws/2020/11/18/indluxdb-aws-cloud-setup.html" rel="alternate" type="text/html" title="Setting up AWS Cloud for InfluxDB" /><published>2020-11-18T00:00:00-06:00</published><updated>2020-11-18T00:00:00-06:00</updated><id>https://andrasnovoszath.com/influxdb/aws/2020/11/18/indluxdb-aws-cloud-setup</id><content type="html" xml:base="https://andrasnovoszath.com/influxdb/aws/2020/11/18/indluxdb-aws-cloud-setup.html">&lt;p&gt;Here are the preparation steps you need to do if you would like to use AWS Cloudwatcher with InfluxDB.&lt;/p&gt;

&lt;p&gt;Based on this &lt;a href=&quot;https://www.influxdata.com/blog/running-influxdb-on-aws-with-cloud-formation/&quot;&gt;post&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;setting-up-an-ec2-virtual-server&quot;&gt;Setting up an EC2 virtual server&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://aws.amazon.com/free/&quot;&gt;Create an AWS account&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Select the appropriate region:
 &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-region.png&quot; alt=&quot;aws region select&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Search for “EC2” in the &lt;strong&gt;Find Services&lt;/strong&gt; search box and select &lt;strong&gt;EC2 (Virtual Servers in the Cloud)&lt;/strong&gt; (Please not that you have to provide credit card information and it may take up to 24 hours for amazon to activate):
 &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-ec2-select.png&quot; alt=&quot;aws ec2 select&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Select &lt;strong&gt;Key Pairs&lt;/strong&gt; and the create a key pair: &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-ec2-key-pairs-menu.png&quot; alt=&quot;key-pairs&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Download the keys.&lt;/li&gt;
  &lt;li&gt;Make the key readable only by the owner: &lt;code class=&quot;highlighter-rouge&quot;&gt;chmod 400 name-of-the-key.pem&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Open &lt;strong&gt;IAM&lt;/strong&gt; from the &lt;strong&gt;Services menu&lt;/strong&gt;: &lt;img src=&quot;/images/influxdb/aws_cloudformation/infludb-aws-select-iam.png&quot; alt=&quot;open-aim&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;Create a user and grant permissions to it:
    &lt;ol&gt;
      &lt;li&gt;Select &lt;strong&gt;Add user&lt;/strong&gt;: &lt;img src=&quot;/images/influxdb/aws_cloudformation/infludb-aws-iam-create-user.png&quot; alt=&quot;iam-new-user&quot; /&gt;&lt;/li&gt;
      &lt;li&gt;Name the user and add access rights: &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-iam-new-user-access.png&quot; alt=&quot;iam-new-user-access&quot; /&gt;&lt;/li&gt;
      &lt;li&gt;On the &lt;strong&gt;Set Permissions&lt;/strong&gt; screen click on &lt;strong&gt;Add user to group&lt;/strong&gt; and &lt;strong&gt;Create a group&lt;/strong&gt;: &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-iam-new-user-create-group.png&quot; alt=&quot;iam-new-user-new-group&quot; /&gt;&lt;/li&gt;
      &lt;li&gt;Define a name and add a policy for the new group: &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-iam-group-permissions.png&quot; alt=&quot;iam-new-group&quot; /&gt;&lt;/li&gt;
      &lt;li&gt;At the end of the process you will see your access details: &lt;img src=&quot;/images/influxdb/aws_cloudformation/influxdb-aws-iam-new-user-success.png&quot; alt=&quot;iam-new-user-success&quot; /&gt;&lt;/li&gt;
    &lt;/ol&gt;

    &lt;p&gt;Note that AWS does not save your secret after you close your final screen. On the other hand, you will always be able to create a new key for your users.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Install the AWS CLI on your system.&lt;/p&gt;

    &lt;p&gt;On a linux machine, you can do this as here:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; curl &lt;span class=&quot;s2&quot;&gt;&quot;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;awscliv2.zip&quot;&lt;/span&gt;
 unzip awscliv2.zip
 &lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; ./aws/install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;Verify your version:&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; aws &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;For further instructions &lt;a href=&quot;https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html&quot;&gt;see here&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Also create a folder where you will store your keys and your yaml configuration.&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; ~/Projects/influxdb_aws_cloudformation
 &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/Projects/influxdb_aws_cloudformation
 &lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; ~/Downloads/name-of-the-key.pem &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
 &lt;span class=&quot;nb&quot;&gt;touch &lt;/span&gt;config.yml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;Configure AWS with &lt;code class=&quot;highlighter-rouge&quot;&gt;aws configure&lt;/code&gt;. This is where you need to add your &lt;strong&gt;Access Key ID&lt;/strong&gt;, your &lt;strong&gt;Secret Access Key&lt;/strong&gt;, and the &lt;strong&gt;region name&lt;/strong&gt; (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;eu-central-1&lt;/code&gt;). You can skip the output format.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;amazon-machine-image&quot;&gt;Amazon Machine Image&lt;/h2&gt;

&lt;p&gt;Open the &lt;a href=&quot;https://aws.amazon.com/marketplace/&quot;&gt;Amazon AWS Marketplace&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Find a public image&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-find-public-image.png&quot; alt=&quot;Find public image&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;defining-resources&quot;&gt;Defining resources&lt;/h2&gt;

&lt;p&gt;Resources
Logical ID
Instance properties
AMI (Amazon Machine Image) ID&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;Resources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Appnode&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AWS::EC2::Instance&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Properties&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;InstanceType&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;t2.nano&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ImageId&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ami-06a719e5f8e22c33b&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# The AMI instance ID&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;Keyname&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;InfluxDB_AWS_example&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# The name of your key pair&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SecurityGroups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;!Ref&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AppnodeSecurityGroup&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Reference the security group defined below&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You need to define a security group. Security groups act as virtual firewalls for your incoming/outgoing traffic with the help of rules. You can read more about them &lt;a href=&quot;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-security-groups.html&quot;&gt;here&lt;/a&gt;. Here, we define an &lt;a href=&quot;https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html&quot;&gt;inbound security group&lt;/a&gt;. For particular rules, &lt;a href=&quot;https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#SecurityGroupRules&quot;&gt;see here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;We define the security group and link it to our app node definition with the &lt;a href=&quot;https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Ref&lt;/code&gt; function&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Define the security group&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;AppnodeSecurityGroup&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AWS::EC2::SecurityGroup&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;Properties&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;GroupDescription&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;SSH enabled app nodes&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Inbound security rule&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Expose the HTTP port 80 with tcp to inbound traffic from andy Ipv4 addresses&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;SecurityGroupIngress&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IpProtocol&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tcp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;FromPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;80'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;ToPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;80'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;CidrIp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0.0.0.0/0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Define Bash script to install docker and influxdb on the image.&lt;/p&gt;

&lt;p&gt;The full yaml:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;Resources&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;AppNode&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AWS::EC2::Instance&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Properties&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;InstanceType&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;t2.micro&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;ImageId&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ami-03d85bfa79ad10274&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;KeyName&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;InfluxDB_AWS_example&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SecurityGroups&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;!Ref&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AppNodeSG&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;UserData&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;!Base64&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;#!/bin/bash&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-get update -qq&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-get install -y apt-transport-https ca-certificates&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-key adv apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-get update -qq apt-get purge lxc-docker || true&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable&quot;&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-get -y install linux-image-extra-$(uname -r) linux-image-extra-virtual&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;apt-get -y install docker-ce&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;usermod -aG docker unbuntu&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;docker image pull quay.io/influxdb/influxdb:2.0.0-alpha&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;docker container run -p 80:9999 quay.io/influxdb/influxdb:2.0.0-alpha&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;wget https://dl.influxdata.com/telegraf/releases/telegraf_1.10.4-1_amd64.deb&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;sudo dpkg -i telegraf_1.10.4-1_amd64.deb&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;AppNodeSG&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;AWS::EC2::SecurityGroup&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;Properties&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;GroupDescription&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;for the app nodes that allow ssh&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;SecurityGroupIngress&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IpProtocol&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tcp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;FromPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;80'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;ToPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;80'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;CidrIp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0.0.0.0/0&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;IpProtocol&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tcp&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;FromPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;22'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;ToPort&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;22'&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;CidrIp&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;0.0.0.0/0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create stack&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;aws cloudformation create-stack &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--stack-name&lt;/span&gt; influxdb-trial-stack &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--region&lt;/span&gt; eu-central-1 &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;--template-body&lt;/span&gt; file://&lt;span class=&quot;nv&quot;&gt;$PWD&lt;/span&gt;/stack.yaml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-23-influxdb-aws-get-instance-dns.png&quot; alt=&quot;Get AMI instance DNS&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Create a connection to our instance:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; InfluxDB_AWS_example.pem &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  ubuntu@ec2-3-122-XXX-XX.eu-central-1.compute.amazonaws.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;install-influxdb&quot;&gt;Install InfluxDB&lt;/h3&gt;
&lt;p&gt;Maybe this: https://websiteforstudents.com/how-to-install-influxdb-on-ubuntu-18-04-16-04/&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://dl.influxdata.com/influxdb/releases/influxdb_2.0.2_amd64.deb
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; influxdb_2.0.2_amd64.deb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Setup InfluxDB configuration settings&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;influx setup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here you need to add a username, a password, and name your organization and your primary bucket. You can skip on the retention period question.&lt;/p&gt;

&lt;h3 id=&quot;run-influxdb-service&quot;&gt;Run influxdb service&lt;/h3&gt;

&lt;p&gt;Start the influxdb service.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start influxdb.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://devconnected.com/how-to-install-influxdb-on-ubuntu-debian-in-2019/#II_Installing_InfluxDB_20&quot;&gt;https://devconnected.com/how-to-install-influxdb-on-ubuntu-debian-in-2019/#II_Installing_InfluxDB_20&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;install-telegraf&quot;&gt;Install telegraf&lt;/h3&gt;

&lt;p&gt;We need to install telegraf onto our instance.&lt;/p&gt;

&lt;p&gt;On an Ubuntu instance this will look like this:&lt;/p&gt;

&lt;p&gt;Adding the repository:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget &lt;span class=&quot;nt&quot;&gt;-qO-&lt;/span&gt; https://repos.influxdata.com/influxdb.key | &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-key add -
&lt;span class=&quot;nb&quot;&gt;source&lt;/span&gt; /etc/lsb-release
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;deb https://repos.influxdata.com/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DISTRIB_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,,&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DISTRIB_CODENAME&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; stable&quot;&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  | &lt;span class=&quot;nb&quot;&gt;sudo tee&lt;/span&gt; /etc/apt/sources.list.d/influxdb.list
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Installing telegraf:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;telegraf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;j&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;telegraf &lt;span class=&quot;nt&quot;&gt;--test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create an example data collection setting config and test it&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;telegraf &lt;span class=&quot;nt&quot;&gt;-sample-config&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--input-filter&lt;/span&gt; cpu:mem &lt;span class=&quot;nt&quot;&gt;--output-filter&lt;/span&gt; influxdb &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; telegraf_test.conf
telegraf &lt;span class=&quot;nt&quot;&gt;--config&lt;/span&gt; telegraf.conf &lt;span class=&quot;nt&quot;&gt;--test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/guides/using_http/&quot;&gt;https://docs.influxdata.com/telegraf/v1.16/guides/using_http/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For other systems and futher information see &lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/introduction/installation/&quot;&gt;this link&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;install-chronograph&quot;&gt;Install Chronograph&lt;/h2&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wget https://dl.influxdata.com/chronograf/releases/chronograf_1.8.8_amd64.deb
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;dpkg &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; chronograf_1.8.8_amd64.deb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;configure-telegraf&quot;&gt;Configure Telegraf&lt;/h3&gt;

&lt;ul class=&quot;task-list&quot;&gt;
  &lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; class=&quot;task-list-item-checkbox&quot; disabled=&quot;disabled&quot; /&gt;&lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/guides/using_http/&quot;&gt;https://docs.influxdata.com/telegraf/v1.16/guides/using_http/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;On Ubuntu instance the config file path is at &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/telegraf/telegraf.conf&lt;/code&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.15/administration/configuration/&quot;&gt;https://docs.influxdata.com/telegraf/v1.15/administration/configuration/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/introduction/getting-started/&quot;&gt;https://docs.influxdata.com/telegraf/v1.16/introduction/getting-started/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For further options and for configuration on other systems, see the &lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/introduction/getting-started/#configure-telegraf&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Starting the Telegraph service:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl start telegraf
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl status telegraf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;instance&quot;&gt;Instance&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-register-new-ami.png&quot; alt=&quot;Register a new Amazon Machine Image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-open-marketplace.png&quot; alt=&quot;Open AWS Marketplace&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-select-ubuntu.png&quot; alt=&quot;Select Ubuntu Image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-subscribe-ami.png&quot; alt=&quot;Subscribe AMI&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Continue to Configuration&lt;/strong&gt;: &lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-terms-conditions.png&quot; alt=&quot;Terms and Conditions&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-configure-ami.png&quot; alt=&quot;Configure AMI&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-launch-instance.png&quot; alt=&quot;Launch Instance&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-instance-type.png&quot; alt=&quot;Instance Type&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-launc-instance.png&quot; alt=&quot;Launch Instance&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-select-key-pair.png&quot; alt=&quot;Select Key Pair&quot; /&gt;&lt;/li&gt;
  &lt;li&gt;&lt;img src=&quot;/images/influxdb/2020-11-20-influxdb-aws-instance-end.png&quot; alt=&quot;Instance Launch Screen&quot; /&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Here are the preparation steps you need to do if you would like to use AWS Cloudwatcher with InfluxDB.</summary></entry><entry><title type="html">Grouping data with Flux in InfluxDB</title><link href="https://andrasnovoszath.com/influxdb/flux/time-series/2020/11/17/influxdb-flux-group.html" rel="alternate" type="text/html" title="Grouping data with Flux in InfluxDB" /><published>2020-11-17T00:00:00-06:00</published><updated>2020-11-17T00:00:00-06:00</updated><id>https://andrasnovoszath.com/influxdb/flux/time-series/2020/11/17/influxdb-flux-group</id><content type="html" xml:base="https://andrasnovoszath.com/influxdb/flux/time-series/2020/11/17/influxdb-flux-group.html">&lt;p&gt;Grouping happens based on &lt;strong&gt;group keys&lt;/strong&gt; which effectilve are the name of columns used for the grouping. A group then consists of rows having identical values in the group key columns.&lt;/p&gt;

&lt;h2 id=&quot;example&quot;&gt;Example&lt;/h2&gt;

&lt;p&gt;Let’s consider the http api request duration data.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-flux&quot;&gt;from(bucket: &quot;trial_bucket&quot;)
  |&amp;gt; range(start: -15m)
  |&amp;gt; filter(fn: (r) =&amp;gt; r._measurement == &quot;http_api_request_duration_seconds&quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In respect to the time columns, it is ‘grouped’, by default, by its ‘start’ and ‘end’ times.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/influxdb-group-default-data.png&quot; alt=&quot;default grouping&quot; /&gt; “Default grouping”&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/influxdb-group-default-chart.png&quot; alt=&quot;default chart&quot; /&gt; “Default grouping as chart”&lt;/p&gt;

&lt;h2 id=&quot;grouping&quot;&gt;Grouping&lt;/h2&gt;

&lt;p&gt;Now, with the following snippet, we group data along the &lt;code class=&quot;highlighter-rouge&quot;&gt;_measurement&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;_field&lt;/code&gt; columns.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-flux&quot;&gt;from(bucket: &quot;trial_bucket&quot;)
  |&amp;gt; range(start: -15m)
  |&amp;gt; filter(fn: (r) =&amp;gt; r._measurement == &quot;http_api_request_duration_seconds&quot;)
  |&amp;gt; group(columns: [&quot;_measurement&quot;, &quot;_field&quot;])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will change the group keys:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/influxdb-group-time-data.png&quot; alt=&quot;grouped keys&quot; /&gt;&lt;/p&gt;

&lt;p&gt;And will also shape the charts:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/influxdb-group-time-chart.png&quot; alt=&quot;grouped by time chart&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As observations of the same time now belong to the same data, plotting them as a line chart on the time axis produces vertical lines.&lt;/p&gt;

&lt;h2 id=&quot;aggregate-and-ungroup&quot;&gt;Aggregate and ungroup&lt;/h2&gt;

&lt;p&gt;For the next step let’s calculate the mean values of the request durations.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-flux&quot;&gt;from(bucket: &quot;trial_bucket&quot;)
  |&amp;gt; range(start: -15m)
  |&amp;gt; filter(fn: (r) =&amp;gt; r._measurement == &quot;http_api_request_duration_seconds&quot;)
  |&amp;gt; group(columns: [&quot;_time&quot;])
  |&amp;gt; mean()
  |&amp;gt; group()  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;While we calucalted the mean values for each timestamp, this also resulted in separate tables consisting of a single value. We can use the &lt;code class=&quot;highlighter-rouge&quot;&gt;group()&lt;/code&gt; function to ungroup data, that is, to merge all tables into a single table.&lt;/p&gt;

&lt;p&gt;This will generate the following chart.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/influxdb/influxdb-group-degroup-chart.png&quot; alt=&quot;mean data&quot; /&gt;&lt;/p&gt;

&lt;p&gt;We can produce the same result by explicitly turning off grouping on specific columns with the &lt;code class=&quot;highlighter-rouge&quot;&gt;mode&lt;/code&gt; parameter.&lt;/p&gt;

&lt;h2 id=&quot;mode&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mode&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;group()&lt;/code&gt; function also accepts a &lt;code class=&quot;highlighter-rouge&quot;&gt;mode&lt;/code&gt; parameter with the following values:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;by&lt;/code&gt;: Group by the columns defined in the &lt;code class=&quot;highlighter-rouge&quot;&gt;columns&lt;/code&gt; parameter.&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;except&lt;/code&gt;: Group by the columns &lt;strong&gt;not defined&lt;/strong&gt; in the &lt;code class=&quot;highlighter-rouge&quot;&gt;columns&lt;/code&gt; parameter.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Accordingly, we can modify the above code to get the same result:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-flux&quot;&gt;from(bucket: &quot;trial_bucket&quot;)
  |&amp;gt; range(start: -15m)
  |&amp;gt; filter(fn: (r) =&amp;gt; r._measurement == &quot;http_api_request_duration_seconds&quot;)
  |&amp;gt; group(columns: [&quot;_time&quot;])
  |&amp;gt; mean()
  |&amp;gt; group(columns: [&quot;_time&quot;, &quot;_value&quot;], mode: &quot;except&quot;)
&lt;/code&gt;&lt;/pre&gt;</content><author><name></name></author><summary type="html">Grouping happens based on group keys which effectilve are the name of columns used for the grouping. A group then consists of rows having identical values in the group key columns.</summary></entry><entry><title type="html">Filtering with Flux in InfluxDB</title><link href="https://andrasnovoszath.com/influxdb/flux/filtering/querying/2020/11/15/influxdb-flux-filter.html" rel="alternate" type="text/html" title="Filtering with Flux in InfluxDB" /><published>2020-11-15T00:00:00-06:00</published><updated>2020-11-15T00:00:00-06:00</updated><id>https://andrasnovoszath.com/influxdb/flux/filtering/querying/2020/11/15/influxdb-flux-filter</id><content type="html" xml:base="https://andrasnovoszath.com/influxdb/flux/filtering/querying/2020/11/15/influxdb-flux-filter.html">&lt;p&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;filter()&lt;/code&gt; function behaves similarly to the &lt;code class=&quot;highlighter-rouge&quot;&gt;WHERE&lt;/code&gt; command in SQL.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-flux&quot;&gt;from(bucket: &quot;trial_bucket&quot;)
  |&amp;gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)
  |&amp;gt; filter(fn: (r) =&amp;gt; r[&quot;_measurement&quot;] == &quot;service_org_duration&quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;fn&lt;/code&gt; parameter expects a &lt;code class=&quot;highlighter-rouge&quot;&gt;predicate function&lt;/code&gt;, that is an anonymous function producing a boolean (&lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;) output. The filtering will include rows for which &lt;code class=&quot;highlighter-rouge&quot;&gt;fn&lt;/code&gt; returns &lt;code class=&quot;highlighter-rouge&quot;&gt;true&lt;/code&gt; based on the expression.&lt;/li&gt;
  &lt;li&gt;The &lt;code class=&quot;highlighter-rouge&quot;&gt;r&lt;/code&gt; argument of the &lt;code class=&quot;highlighter-rouge&quot;&gt;fn&lt;/code&gt; parameter stands for the rows.&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">The filter() function behaves similarly to the WHERE command in SQL.</summary></entry><entry><title type="html">Writing data to InfluxDB with Telegraf</title><link href="https://andrasnovoszath.com/influxdb/time-series/database/2020/11/14/influxdb-telegraf.html" rel="alternate" type="text/html" title="Writing data to InfluxDB with Telegraf" /><published>2020-11-14T00:00:00-06:00</published><updated>2020-11-14T00:00:00-06:00</updated><id>https://andrasnovoszath.com/influxdb/time-series/database/2020/11/14/influxdb-telegraf</id><content type="html" xml:base="https://andrasnovoszath.com/influxdb/time-series/database/2020/11/14/influxdb-telegraf.html">&lt;h2 id=&quot;what-is-telegraf&quot;&gt;What is Telegraf?&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.influxdata.com/time-series-platform/telegraf/&quot;&gt;Telegraf&lt;/a&gt; is InfluxData’s time series data collection and reporting agent. Its main functionality is to collect data with the help of its plugins from a wide range of sources and to feed it to an InfluxDB database. It also can ingest data from InfluxDB databases and generate reports on them.&lt;/p&gt;

&lt;p&gt;At the time of writing, it has more than 200 integrations, like Amazon ECS and Docker. You can see the full list &lt;a href=&quot;https://www.influxdata.com/products/integrations/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Using Telegraf with InfluxDB most importantly consists of configuring Telegraf either automatically or manually. Configurations are stored in &lt;code class=&quot;highlighter-rouge&quot;&gt;telegraf.conf&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The following steps assume that you have Telegraf installed and running. If this is not the case, you can follow the instructions &lt;a href=&quot;https://docs.influxdata.com/telegraf/v1.16/introduction/installation/&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;automatic-configuration&quot;&gt;Automatic configuration&lt;/h2&gt;

&lt;p&gt;You can set up a subset of Telegraf plugins automatically (for the rest, do manual configuration).&lt;/p&gt;

&lt;p&gt;Steps in the InfluxDB UI:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Open the &lt;strong&gt;Data&lt;/strong&gt; screen from the navigation menu&lt;/li&gt;
  &lt;li&gt;Select the &lt;strong&gt;Telegraf&lt;/strong&gt; tab&lt;/li&gt;
  &lt;li&gt;Select &lt;strong&gt;Create Configuration&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;In the &lt;strong&gt;Bucket&lt;/strong&gt; dropdown, choose the bucket to where you want to write the data&lt;/li&gt;
  &lt;li&gt;Select the plugin groups you would like to use and click &lt;strong&gt;Continue&lt;/strong&gt;. This will open a new window&lt;/li&gt;
  &lt;li&gt;In the window, add a name and description (optional)&lt;/li&gt;
  &lt;li&gt;If needed, configure the individual plugins within the group. (A green checkmark denotes plugins with no need of configuration)&lt;/li&gt;
  &lt;li&gt;Click &lt;strong&gt;Create and Verify&lt;/strong&gt;. This opens a test page.&lt;/li&gt;
  &lt;li&gt;In the test page, follow the instructions to set up telegraf and click &lt;strong&gt;Listen to Data&lt;/strong&gt;. This should result in a &lt;strong&gt;Connection Found!&lt;/strong&gt; message.&lt;/li&gt;
  &lt;li&gt;You can close the screen with the &lt;strong&gt;Finish&lt;/strong&gt; button.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For using Telegraf with Window host monitoring, you may need to do some following configuration, see &lt;a href=&quot;https://docs.influxdata.com/influxdb/v2.0/write-data/no-code/use-telegraf/auto-config/#windows&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;</content><author><name></name></author><summary type="html">What is Telegraf?</summary></entry><entry><title type="html">Notifications in InfluxDB</title><link href="https://andrasnovoszath.com/influxdb/monitoring/time-series/notification/2020/11/13/influxdb-notifications.html" rel="alternate" type="text/html" title="Notifications in InfluxDB" /><published>2020-11-13T00:00:00-06:00</published><updated>2020-11-13T00:00:00-06:00</updated><id>https://andrasnovoszath.com/influxdb/monitoring/time-series/notification/2020/11/13/influxdb-notifications</id><content type="html" xml:base="https://andrasnovoszath.com/influxdb/monitoring/time-series/notification/2020/11/13/influxdb-notifications.html">&lt;h2 id=&quot;notification-endpoints&quot;&gt;Notification endpoints&lt;/h2&gt;

&lt;p&gt;Notification endpoints define connections to third party services.&lt;/p&gt;

&lt;h3 id=&quot;create-notification-endpoints&quot;&gt;Create notification endpoints&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Select the &lt;strong&gt;Alerts&lt;/strong&gt; screen from the navigation menu;&lt;/li&gt;
  &lt;li&gt;At the top of the &lt;strong&gt;Notification Endpoints&lt;/strong&gt; section click the &lt;strong&gt;Create&lt;/strong&gt; button;&lt;/li&gt;
  &lt;li&gt;Select a &lt;strong&gt;Destination&lt;/strong&gt; from the drop-down menu;&lt;/li&gt;
  &lt;li&gt;Add a name and a description (optional);&lt;/li&gt;
  &lt;li&gt;Add the destination-specific configurations;&lt;/li&gt;
  &lt;li&gt;Click &lt;strong&gt;Create&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;For specific details for the different endpoints, see the &lt;a href=&quot;https://docs.influxdata.com/influxdb/v2.0/monitor-alert/notification-endpoints/create/&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;manage-notification-endpoints&quot;&gt;Manage notification endpoints&lt;/h3&gt;

&lt;p&gt;In the &lt;strong&gt;Alerts&lt;/strong&gt; menu, under the &lt;strong&gt;Notification Endpoints&lt;/strong&gt; section, you can manage notifications. In particular, you can:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Review the &lt;strong&gt;list&lt;/strong&gt; of the existing notification endpoints;&lt;/li&gt;
  &lt;li&gt;Review their &lt;strong&gt;history&lt;/strong&gt; (eye icon);&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt; a notification behavior (by clicking on their name);&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Rename&lt;/strong&gt; them (pen icon next to their name);&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Turn them on/off&lt;/strong&gt; (toggle button);&lt;/li&gt;
  &lt;li&gt;Add &lt;strong&gt;labels&lt;/strong&gt; to them;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Delete&lt;/strong&gt; them (trash icon).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;notification-rules&quot;&gt;Notification rules&lt;/h2&gt;

&lt;p&gt;Notification rules generate notifications by triggering notificaton endpoints based on a given condition regarding the outcome of checks.&lt;/p&gt;

&lt;h3 id=&quot;create-notification-rules&quot;&gt;Create notification rules&lt;/h3&gt;

&lt;p&gt;Before your first notification rule, you need to have at least one notification endpoint in place.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Select the &lt;strong&gt;Alerts&lt;/strong&gt; screen from the navigation menu.&lt;/li&gt;
  &lt;li&gt;At the top of the &lt;strong&gt;Notification Rules&lt;/strong&gt; section click the &lt;strong&gt;Create&lt;/strong&gt; button;&lt;/li&gt;
  &lt;li&gt;In the &lt;strong&gt;About&lt;/strong&gt; section add
    &lt;ol&gt;
      &lt;li&gt;&lt;strong&gt;Name&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Schedule&lt;/strong&gt;: how often you would like the notification to review checks and trigger a message&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Offset&lt;/strong&gt;: the delay relative to the start time of the intervals set under &lt;strong&gt;Schedule&lt;/strong&gt;.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;In the &lt;strong&gt;Conditions&lt;/strong&gt; section, define the rule that will trigger the notification based on check statuses and (optionally) on tag values.&lt;/li&gt;
  &lt;li&gt;In the &lt;strong&gt;Messages&lt;/strong&gt; section select which endpoint should the rule trigger.&lt;/li&gt;
  &lt;li&gt;Click &lt;strong&gt;Create Notification Rule&lt;/strong&gt;.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;manage-notification-rules&quot;&gt;Manage notification rules&lt;/h3&gt;

&lt;p&gt;In the &lt;strong&gt;Alerts&lt;/strong&gt; screen, under the &lt;strong&gt;Notification Rules&lt;/strong&gt; section, you can manage notifications. In particular, you can:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Review the &lt;strong&gt;list&lt;/strong&gt; of the existing notification rules;&lt;/li&gt;
  &lt;li&gt;Review their &lt;strong&gt;history&lt;/strong&gt; (eye icon, &lt;strong&gt;View History&lt;/strong&gt;);&lt;/li&gt;
  &lt;li&gt;Create a &lt;strong&gt;clone&lt;/strong&gt; of an existing notification (clone icon)&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt; a notification behavior (by clicking on their name);&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Rename&lt;/strong&gt; them (pen icon next to their name);&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Turn them on/off&lt;/strong&gt; (toggle button);&lt;/li&gt;
  &lt;li&gt;Add &lt;strong&gt;labels&lt;/strong&gt; to them;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Delete&lt;/strong&gt; them (trash icon).&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><summary type="html">Notification endpoints</summary></entry><entry><title type="html">Checks in InlfuxDB</title><link href="https://andrasnovoszath.com/2020/11/12/influxdb-check.html" rel="alternate" type="text/html" title="Checks in InlfuxDB" /><published>2020-11-12T00:00:00-06:00</published><updated>2020-11-12T00:00:00-06:00</updated><id>https://andrasnovoszath.com/2020/11/12/influxdb-check</id><content type="html" xml:base="https://andrasnovoszath.com/2020/11/12/influxdb-check.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-12-influxdb-check.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You can use InfluxDB to monitor your data and generate notifications reporting its status.&lt;/p&gt;
&lt;h2 id=&quot;Concepts&quot;&gt;Concepts&lt;a class=&quot;anchor-link&quot; href=&quot;#Concepts&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Check&lt;/strong&gt;: generate statuses based on a queries expressing a conditino. It stores them in the &lt;code&gt;_monitoring&lt;/code&gt; bucket (under &lt;code&gt;statuses&lt;/code&gt; measurement)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Notification rule&lt;/strong&gt;: check the &lt;code&gt;statuses&lt;/code&gt; measurement and, based on its own conditions, triggers the notification endpoint. It also stores notifications in the &lt;code&gt;_monitoring&lt;/code&gt; bucket (under &lt;code&gt;notifications&lt;/code&gt; measurement)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Notification endpoint&lt;/strong&gt;: &lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Checks&quot;&gt;Checks&lt;a class=&quot;anchor-link&quot; href=&quot;#Checks&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The elements of a check:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Query: Defines what to monitor.&lt;/li&gt;
&lt;li&gt;Configuration: defines check interval, messages, and status.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Check types&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Threshold check&lt;/strong&gt;: monitors a value against (high/low) thresholds and assigns one of the following values: &lt;strong&gt;CRIT&lt;/strong&gt;, &lt;strong&gt;WARN&lt;/strong&gt;, &lt;strong&gt;INFO&lt;/strong&gt;, &lt;strong&gt;OK&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Deadman check&lt;/strong&gt;: monitors if a series or group responds within a given amount of time.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-a-check&quot;&gt;Create a check&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-check&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Select the &lt;strong&gt;Alerts&lt;/strong&gt; menu in the navigation pane.&lt;/li&gt;
&lt;li&gt;Click on &lt;strong&gt;Create&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select the check type.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Query&quot;&gt;Query&lt;a class=&quot;anchor-link&quot; href=&quot;#Query&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;By default, you will find yourself in the &lt;strong&gt;Define Query&lt;/strong&gt; screen.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Select the &lt;strong&gt;bucket&lt;/strong&gt;, the &lt;strong&gt;measurement&lt;/strong&gt;, the &lt;strong&gt;field&lt;/strong&gt;, and the &lt;strong&gt;tag sets&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;For threshold check: Select an &lt;strong&gt;aggregate function&lt;/strong&gt; (e.g. mean, median, std, etc.).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can preview the results of the query by clicking on &lt;strong&gt;Submit&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;After these steps, select the &lt;strong&gt;Configure Check&lt;/strong&gt; screen.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Define the check schedule interval (this updates the aggregate function interval).&lt;/li&gt;
&lt;li&gt;Filter the check based on tags (Optional).&lt;/li&gt;
&lt;li&gt;Edit the status message template (Optional).&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;For threshold check: define the thresholds and rules that will trigger the specific statuses. You can also set them with the mouse by moving their respective labels on the preview screen.&lt;/li&gt;
&lt;li&gt;For deadman check: specify the duration to check for, the status the lack of series or groups should trigger, and time after which it should stop checking the series / group.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Finally, name the check at the top of the screen.&lt;/p&gt;
&lt;p&gt;Click the green checkmark to save the check.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">InfluxDB tasks</title><link href="https://andrasnovoszath.com/2020/11/05/influxdb-tasks.html" rel="alternate" type="text/html" title="InfluxDB tasks" /><published>2020-11-05T00:00:00-06:00</published><updated>2020-11-05T00:00:00-06:00</updated><id>https://andrasnovoszath.com/2020/11/05/influxdb-tasks</id><content type="html" xml:base="https://andrasnovoszath.com/2020/11/05/influxdb-tasks.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-05-influxdb-tasks.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Tasks are scheduled Flux queries that allow you to process data with InfluxDB.&lt;/p&gt;
&lt;h3 id=&quot;Task-components&quot;&gt;Task components&lt;a class=&quot;anchor-link&quot; href=&quot;#Task-components&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Tasks should have the following components:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Options&lt;/li&gt;
&lt;li&gt;Data source&lt;/li&gt;
&lt;li&gt;Processing steps&lt;/li&gt;
&lt;li&gt;Destination&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Task-Options&quot;&gt;Task Options&lt;a class=&quot;anchor-link&quot; href=&quot;#Task-Options&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can specify options that tasks will use. This makes it easier to reuse and modify your tasks.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;option task = {
    // Task name
    name: &quot;monitor task&quot;,

    // Run interval
    every: 5m,

    // Cron job
    cron : &quot;0 * * * * *&quot;

    // Task start delay
    offset: 10m,

    // Maximum number of concurrent tasks
    concurrency: 2,

    // Number of tries before getting failed status
    retry: 5,
}&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Task-data-source&quot;&gt;Task data source&lt;a class=&quot;anchor-link&quot; href=&quot;#Task-data-source&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can use the &lt;code&gt;from()&lt;/code&gt; function to specify the data you try to get.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;data = from(bucket: &quot;status info&quot;)
  // `-task.every` is a task option passed here
  |&amp;gt; range(start: -task.every)
  |&amp;gt; filter(fn: (r) =&amp;gt;
    r._measurement == &quot;temperature&quot; and
    r.host == &quot;dataSource&quot;
  )&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Data-processing-and-destination&quot;&gt;Data processing and destination&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-processing-and-destination&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can use the &lt;code&gt;to()&lt;/code&gt; function to store the results in another bucket.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;data
  // Process
  |&amp;gt; aggregateWindow(
      every: 1h,
      fn: sum
  )

  // Store results
  |&amp;gt; to(bucket: &quot;status_log&quot;, org: &quot;logger&quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can learn more about data processing in the &lt;a href=&quot;https://docs.influxdata.com/influxdb/v2.0/process-data/common-tasks/&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-a-task-in-the-UI&quot;&gt;Create a task in the UI&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-task-in-the-UI&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the UI, you can create tasks by the following ways&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;Data Explorer&lt;/strong&gt; screen&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;Task&lt;/strong&gt; screen&lt;/li&gt;
&lt;li&gt;Import (in the &lt;strong&gt;Task&lt;/strong&gt; screen)&lt;/li&gt;
&lt;li&gt;Create from template (in the &lt;strong&gt;Settings&lt;/strong&gt; screen)&lt;/li&gt;
&lt;li&gt;Clone a taks (in the &lt;strong&gt;Task&lt;/strong&gt; screen)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Data-Explorer&quot;&gt;Data Explorer&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-Explorer&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Open the &lt;strong&gt;Data Explorer&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Task&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Define the task options.&lt;/li&gt;
&lt;li&gt;Select a token.&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Save as Task&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Task-UI&quot;&gt;Task UI&lt;a class=&quot;anchor-link&quot; href=&quot;#Task-UI&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Open the &lt;strong&gt;Task&lt;/strong&gt; screen&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Create Task&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;New Task&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Define the task options.&lt;/li&gt;
&lt;li&gt;Select a token.&lt;/li&gt;
&lt;li&gt;Enter your script&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Save&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Custom dashboard variables in InfluxDB</title><link href="https://andrasnovoszath.com/2020/11/04/influxdb-custom-dashboard-variables.html" rel="alternate" type="text/html" title="Custom dashboard variables in InfluxDB" /><published>2020-11-04T00:00:00-06:00</published><updated>2020-11-04T00:00:00-06:00</updated><id>https://andrasnovoszath.com/2020/11/04/influxdb-custom-dashboard-variables</id><content type="html" xml:base="https://andrasnovoszath.com/2020/11/04/influxdb-custom-dashboard-variables.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-04-influxdb-custom-dashboard-variables.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You can create a new variable in the &lt;strong&gt;Data Explorer&lt;/strong&gt;, in the &lt;strong&gt;Settings&lt;/strong&gt; or import from InfluxDB in JSON. Here we review the steps to create a variable in the &lt;strong&gt;Data Explorer&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dashboard-variable-types&quot;&gt;Dashboard variable types&lt;a class=&quot;anchor-link&quot; href=&quot;#Dashboard-variable-types&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;There are three types of dashboard variables. The types refert to the structuring of the variable's possible values.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Map: stores values as key/value pairs in a comma separated format. The UI presents the keys but works with the values.&lt;/li&gt;
&lt;li&gt;Query: uses values from a Flux query's &lt;code&gt;_value&lt;/code&gt; column. (If the values are in another colum, you can first rename that column to &lt;code&gt;_value&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;CSV: uses a CSV-formatted list.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-variable-in-Data-Explorer&quot;&gt;Create variable in Data Explorer&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-variable-in-Data-Explorer&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Open the &lt;strong&gt;Data Explorer&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Build a query with the &lt;strong&gt;Query Builder&lt;/strong&gt; or the &lt;strong&gt;Script Editor&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Save As&lt;/strong&gt; at the top right corner&lt;/li&gt;
&lt;li&gt;Select the &lt;strong&gt;Variable&lt;/strong&gt; tab.&lt;/li&gt;
&lt;li&gt;Add a name for the variable and click &lt;strong&gt;Save as Variable&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Viewing-dashboard-variables&quot;&gt;Viewing dashboard variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Viewing-dashboard-variables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can view variables which belong to your &lt;strong&gt;organization&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;You can review them in two places:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;In the &lt;strong&gt;Settings&lt;/strong&gt; menu on the &lt;strong&gt;Variables&lt;/strong&gt; tab&lt;/li&gt;
&lt;li&gt;In the &lt;strong&gt;Data Explorer&lt;/strong&gt;, in &lt;strong&gt;Script Editor&lt;/strong&gt; mode under the &lt;strong&gt;Variables&lt;/strong&gt; tab.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Update,-export,-or-delete-a-dashboard-variable&quot;&gt;Update, export, or delete a dashboard variable&lt;a class=&quot;anchor-link&quot; href=&quot;#Update,-export,-or-delete-a-dashboard-variable&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Open the &lt;strong&gt;Settings&lt;/strong&gt; menu in the navigation bar&lt;/li&gt;
&lt;li&gt;Select the &lt;strong&gt;Variables&lt;/strong&gt; tab.&lt;/li&gt;
&lt;li&gt;For update, click on a variable's name in the list. To rename, export, or delete, select the appropriate icon in the top right corner of their card.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Variable-queries&quot;&gt;Variable queries&lt;a class=&quot;anchor-link&quot; href=&quot;#Variable-queries&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;List-buckets&quot;&gt;List buckets&lt;a class=&quot;anchor-link&quot; href=&quot;#List-buckets&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;// List buckets in the current organization
buckets()

// Rename the `name` column to `_value`
  |&amp;gt; rename(columns: {&quot;name&quot;: &quot;_value&quot;})

// Return a table only with the specific columns
  |&amp;gt; keep(columns: [&quot;_value&quot;])&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;List-measurements&quot;&gt;List measurements&lt;a class=&quot;anchor-link&quot; href=&quot;#List-measurements&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;// List all measurements in the bucket

// Import the schema package
import &quot;influxdata/influxdb/schema&quot;

// List the measurements of the specified bucket
schema.measurements(bucket: &quot;bucket-name&quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;List-fields-in-a-measurement&quot;&gt;List fields in a measurement&lt;a class=&quot;anchor-link&quot; href=&quot;#List-fields-in-a-measurement&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;List field in the specified bucket + measurement.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// Import the schema package
import &quot;influxdata/influxdb/schema&quot;

schema.measurementTagValues(
  bucket: &quot;bucket-name&quot;,
  measurement: &quot;measurement-name&quot;,
  tag: &quot;_field&quot;
)&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;List-unique-tag-values&quot;&gt;List unique tag values&lt;a class=&quot;anchor-link&quot; href=&quot;#List-unique-tag-values&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;List the unique values of the &lt;code&gt;host&lt;/code&gt; tag.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;import &quot;influxdata/influxdb/schema&quot;

schame.measurementTagValues(bucket: &quot;bucket-name&quot;, tag: &quot;host&quot;)&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Dashboard variables in InfluxDB</title><link href="https://andrasnovoszath.com/2020/11/03/influxdb-dashboard-variables.html" rel="alternate" type="text/html" title="Dashboard variables in InfluxDB" /><published>2020-11-03T00:00:00-06:00</published><updated>2020-11-03T00:00:00-06:00</updated><id>https://andrasnovoszath.com/2020/11/03/influxdb-dashboard-variables</id><content type="html" xml:base="https://andrasnovoszath.com/2020/11/03/influxdb-dashboard-variables.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-03-influxdb-dashboard-variables.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Variables&quot;&gt;Variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Variables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Dashboard variables are useful when you would like to modify dashboard cells without editing the original queries based on which the dashboard is built. You can also use Flux to build queries for dashboard cells.&lt;/p&gt;
&lt;p&gt;Dashboard variables can be&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Predefined: &lt;code&gt;v.timeRangeStart&lt;/code&gt;, &lt;code&gt;v.timeRangeStop&lt;/code&gt;, &lt;code&gt;v.windowPeriod&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Custom: defined in the user interface&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Quering-a-variable&quot;&gt;Quering a variable&lt;a class=&quot;anchor-link&quot; href=&quot;#Quering-a-variable&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Variables are stored in a &lt;code&gt;v&lt;/code&gt; standing for a particular dashboard&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;from(bucket: v.bucket)
  |&amp;gt; range(start: v.timeRangeStart, stop: v.timeRangeStop)
  |&amp;gt; filter(fn: (r) =&amp;gt; r._measurement == v._measurement and r.field == v.field)
  |&amp;gt; aggregateWindow(every: v.windowPeriod, fn: mean)&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;Adding-a-variable&quot;&gt;Adding a variable&lt;a class=&quot;anchor-link&quot; href=&quot;#Adding-a-variable&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;Check available variables on the right hand side under the &lt;strong&gt;Variables&lt;/strong&gt; tab&lt;/li&gt;
&lt;li&gt;Select the name of the variable you would like to add&lt;/li&gt;
&lt;li&gt;Select a value from the &lt;strong&gt;Value&lt;/strong&gt; dropdown&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Linking-a-dashboard-with-variables&quot;&gt;Linking a dashboard with variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Linking-a-dashboard-with-variables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;After adding the variable, the dashboard's url will have the following structure appended to its end &lt;code&gt;&amp;amp;vars[variable_name]=value&lt;/code&gt;. This allows you to directly share the dashboard with the variable included with a simple url.&lt;/p&gt;
&lt;h2 id=&quot;Custom-variables&quot;&gt;Custom variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Custom-variables&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;You can create variables for your dashboard in the following ways:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;in the &lt;strong&gt;Data Explorer&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;in &lt;strong&gt;Settings&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;via import&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Naming-restrictions&quot;&gt;Naming restrictions&lt;a class=&quot;anchor-link&quot; href=&quot;#Naming-restrictions&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Variable names has to&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;be unique&lt;/li&gt;
&lt;li&gt;start with and underscore '&lt;code&gt;_&lt;/code&gt;'&lt;/li&gt;
&lt;li&gt;they cannot be one of the Flux reserved keywords: and, import, not, return, option, test, empty, in, or, package, and builtin.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Data visualization and dashboards with InfluxDB</title><link href="https://andrasnovoszath.com/2020/11/02/influxdb-visualization-dashboard.html" rel="alternate" type="text/html" title="Data visualization and dashboards with InfluxDB" /><published>2020-11-02T00:00:00-06:00</published><updated>2020-11-02T00:00:00-06:00</updated><id>https://andrasnovoszath.com/2020/11/02/influxdb-visualization-dashboard</id><content type="html" xml:base="https://andrasnovoszath.com/2020/11/02/influxdb-visualization-dashboard.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-02-influxdb-visualization-dashboard.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Visualizations&quot;&gt;Visualizations&lt;a class=&quot;anchor-link&quot; href=&quot;#Visualizations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ol&gt;
&lt;li&gt;Open &lt;strong&gt;Data Explorer&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Create a flux query (either with the panel at the bottom, or writing manually in the &lt;strong&gt;Script Editor&lt;/strong&gt;)&lt;/li&gt;
&lt;li&gt;Press &lt;strong&gt;Submit&lt;/strong&gt; to run the query. This will generate the graph preview.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;You can add further queries with the &lt;code&gt;+&lt;/code&gt; button&lt;/li&gt;
&lt;li&gt;You an hide/show the visualizations by clicking on the eye icon&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can choose a different graph type from the left menu.&lt;/p&gt;
&lt;p&gt;To see you data in a tablet format, turn on the &lt;strong&gt;View Raw Data&lt;/strong&gt; switch.&lt;/p&gt;
&lt;p&gt;You can refresh the dashboard with the refresh button. 
You can change the auto-refresh interval (by default it is stopped and shows a pause sign).&lt;/p&gt;
&lt;p&gt;You can save your query as a dashboard cell by clicking on the &lt;strong&gt;Save as&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dashboards&quot;&gt;Dashboards&lt;a class=&quot;anchor-link&quot; href=&quot;#Dashboards&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ol&gt;
&lt;li&gt;Select the &lt;strong&gt;Boards&lt;/strong&gt; menu item in the navigation menu.&lt;/li&gt;
&lt;li&gt;Select &lt;strong&gt;Create Dashboard&lt;/strong&gt; menu in the middle and select &lt;strong&gt;New Dashboard&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Name the dashboard at the top field (saying &lt;strong&gt;Name this dashboard&lt;/strong&gt;)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can also import a dashboard from a file or simply pasting a JSON file.&lt;/p&gt;
&lt;p&gt;You can also create a new dashboard from templates.&lt;/p&gt;
&lt;p&gt;You can also clone your dashboard and change it for another need.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For these operations you need to open a dashboard (e.g. by clicking on its name in the &lt;strong&gt;Boards&lt;/strong&gt; screen).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;You can add further data to your dashboard with the &lt;strong&gt;Add cell&lt;/strong&gt; button at the top left corner.&lt;/li&gt;
&lt;li&gt;You can add notes to your dashboard with the &lt;strong&gt;Add Note&lt;/strong&gt; buttom at the top left corner.&lt;/li&gt;
&lt;li&gt;Change time zone&lt;/li&gt;
&lt;li&gt;Manually refresh&lt;/li&gt;
&lt;li&gt;Set automatic refresh interval&lt;/li&gt;
&lt;li&gt;Select time range&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Further-operations&quot;&gt;Further operations&lt;a class=&quot;anchor-link&quot; href=&quot;#Further-operations&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Export&lt;/strong&gt;: Click on the gear icon and select &lt;strong&gt;Export&lt;/strong&gt;. You can export the dashboard as&lt;ul&gt;
&lt;li&gt;JSON file&lt;/li&gt;
&lt;li&gt;A template
Or you can copy the JSON to the clipboard.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Delete&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry></feed>