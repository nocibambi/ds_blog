---
keywords: fastai
title: Docker cheatsheet
nb_path: _notebooks/2020-10-06-docker-cheatsheet.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-06-docker-cheatsheet.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Main ideas and docker file commands (<a href="https://towardsdatascience.com/how-docker-can-help-you-become-a-more-effective-data-scientist-7fc048ef91d5">based on this blog post</a>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Glossary">Glossary<a class="anchor-link" href="#Glossary"> </a></h2><ul>
<li>Image: blueprint to build</li>
<li>Container: instance of image</li>
<li>Dockerfile: recipe for image, a text file</li>
<li>Layer: modifications of the image</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dockerfile-commands">Dockerfile commands<a class="anchor-link" href="#Dockerfile-commands"> </a></h2><ul>
<li><code>FROM ubuntu:18.04</code>: build image upon ubuntu base image</li>
<li><code>LABEL maintainer="Firstname Lastname email</code>: optioal metadata</li>
<li><code>ENV LANG=C.UTF-8 LC_ALL=C.UTF-8</code>: Environment variables</li>
<li><code>RUN apt-get update &amp;&amp; apt-get install -y python-pip</code>: shell commands to run</li>
<li><code>EXPOSE 7745</code>: open a port (e.g. for jupyter). Publises only if used <code>-p</code> or <code>-P</code> with <code>run</code></li>
<li><code>VOLUME /ds</code>:<ul>
<li>mount externally mounted volumes (need to specify the mountpoint at container run/creation)</li>
<li>data inside this won't be saved, but outide of it will</li>
</ul>
</li>
<li><code>WORKDIR /ds</code>: starting point for relative file references</li>
<li><code>COPY hom* /mydir/</code>: copies new files and add them to the container's filesystem at a destination path</li>
<li><code>CMD ['/bin/bash']</code>:<ul>
<li>run a bash shell to prevent closing the container</li>
<li>only the last <code>CMD</code> will be executed</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-a-Docker-Image">Build a Docker Image<a class="anchor-link" href="#Build-a-Docker-Image"> </a></h2><div class="highlight"><pre><span></span>docker build -t tutorial -f ./Dockerfile.gpu ./
</pre></div>
<p>(This builds an <strong>image</strong> not a container)</p>
<ul>
<li><code>-t tutorial</code>: name or tag</li>
<li><code>-f ./Dockerfile.gpu</code>: Dockerfile location</li>
<li><code>./</code>: context host directory, the relative path refrence point</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-a-Docker-container-from-an-Image">Build a Docker container from an Image<a class="anchor-link" href="#Build-a-Docker-container-from-an-Image"> </a></h2><div class="highlight"><pre><span></span>docker run -it --name container1 --net<span class="o">=</span>host -v ~/docker_files/:/ds tutorial
</pre></div>
<ul>
<li><code>-it</code>: interactive run</li>
<li><code>--net=host</code>: bind ports to host</li>
<li><code>-v /docker_files/:/ds</code>: Mount host directory to you as a volume : the mount detination</li>
<li><a href="/ds_blog/images/copied_from_nb/tutorial"><code>tutorial</code></a>: image name</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Container-related-commands">Container-related commands<a class="anchor-link" href="#Container-related-commands"> </a></h2><p>Open a terminal iteractively in the <code>container1</code> container.</p>
<div class="highlight"><pre><span></span>docker <span class="nb">exec</span> -it container1 bash
</pre></div>
<p>Save current state of container as new image (username is e.g. for DockerHub)</p>
<div class="highlight"><pre><span></span>docker commit container1 username/image2name:tagname
</pre></div>
<p>List running containers</p>
<div class="highlight"><pre><span></span>docker ps -a -f <span class="nv">status</span><span class="o">=</span>running
</pre></div>
<p>List images</p>
<div class="highlight"><pre><span></span>docker images
</pre></div>
<p>Push image to registry</p>
<div class="highlight"><pre><span></span>docker push username/image2name:tagname
</pre></div>

</div>
</div>
</div>
</div>
 

