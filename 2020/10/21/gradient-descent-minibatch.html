<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Gradient Descent Minibatch | Value this</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Gradient Descent Minibatch" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is not another blog about bitcoin." />
<meta property="og:description" content="This is not another blog about bitcoin." />
<link rel="canonical" href="https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html" />
<meta property="og:url" content="https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html" />
<meta property="og:site_name" content="Value this" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-21T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This is not another blog about bitcoin.","headline":"Gradient Descent Minibatch","dateModified":"2020-10-21T00:00:00-05:00","datePublished":"2020-10-21T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html"},"url":"https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://andrasnovoszath.com/feed.xml" title="Value this" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-178880214-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Gradient Descent Minibatch | Value this</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Gradient Descent Minibatch" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This is not another blog about bitcoin." />
<meta property="og:description" content="This is not another blog about bitcoin." />
<link rel="canonical" href="https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html" />
<meta property="og:url" content="https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html" />
<meta property="og:site_name" content="Value this" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-21T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This is not another blog about bitcoin.","headline":"Gradient Descent Minibatch","dateModified":"2020-10-21T00:00:00-05:00","datePublished":"2020-10-21T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html"},"url":"https://andrasnovoszath.com/2020/10/21/gradient-descent-minibatch.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://andrasnovoszath.com/feed.xml" title="Value this" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-178880214-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Value this</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Gradient Descent Minibatch</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-10-21T00:00:00-05:00" itemprop="datePublished">
        Oct 21, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/nocibambi/ds_blog/tree/master/_notebooks/2020-10-21-gradient-descent-minibatch.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/nocibambi/ds_blog/master?filepath=_notebooks%2F2020-10-21-gradient-descent-minibatch.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/nocibambi/ds_blog/blob/master/_notebooks/2020-10-21-gradient-descent-minibatch.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-21-gradient-descent-minibatch.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Gradiant-descent-with-minibatches">Gradiant descent with minibatches<a class="anchor-link" href="#Gradiant-descent-with-minibatches"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Libraries-and-helper-functions">Libraries and helper functions<a class="anchor-link" href="#Libraries-and-helper-functions"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Iterator</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Vector</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">vector1</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">vector2</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span> <span class="k">for</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vector1</span><span class="p">,</span> <span class="n">vector2</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vector_sum</span><span class="p">(</span><span class="n">vectors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">vectors</span>
    
    <span class="n">vector_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vectors</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">vector_length</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">)</span>

    <span class="n">sums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">vector_length</span>
    <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">:</span>
        <span class="n">sums</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">sums</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sums</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">scalar_multiply</span><span class="p">(</span><span class="n">c</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="o">*</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vector</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">vector_mean</span><span class="p">(</span><span class="n">vectors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Vector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scalar_multiply</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">,</span> <span class="n">vector_sum</span><span class="p">(</span><span class="n">vectors</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">gradient_step</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">gradient</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">step_size</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return vector adjusted with step. Step is gradient times step size.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">scalar_multiply</span><span class="p">(</span><span class="n">step_size</span><span class="p">,</span> <span class="n">gradient</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear_gradient</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="n">Vector</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Vector</span><span class="p">:</span>
    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">theta</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
    <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="c1">#** 2</span>
    <span class="c1"># print(x, y, theta, predicted, error)</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">error</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">error</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Minibatch-gradient">Minibatch gradient<a class="anchor-link" href="#Minibatch-gradient"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">minibatches</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]]:</span>
    <span class="n">batch_starts</span> <span class="o">=</span> <span class="p">[</span><span class="n">start</span> <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">batch_starts</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">batch_starts</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">batch_size</span>
        <span class="k">yield</span> <span class="n">dataset</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)]</span>
<span class="n">inputs</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(-50, -995),
 (-49, -975),
 (-48, -955),
 (-47, -935),
 (-46, -915),
 (-45, -895),
 (-44, -875),
 (-43, -855),
 (-42, -835),
 (-41, -815)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">minibatches</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[(-50, -995), (-49, -975), (-48, -955), (-47, -935), (-46, -915)]
[(-45, -895), (-44, -875), (-43, -855), (-42, -835), (-41, -815)]
[(-40, -795), (-39, -775), (-38, -755), (-37, -735), (-36, -715)]
[(-35, -695), (-34, -675), (-33, -655), (-32, -635), (-31, -615)]
[(-30, -595), (-29, -575), (-28, -555), (-27, -535), (-26, -515)]
[(-25, -495), (-24, -475), (-23, -455), (-22, -435), (-21, -415)]
[(-20, -395), (-19, -375), (-18, -355), (-17, -335), (-16, -315)]
[(-15, -295), (-14, -275), (-13, -255), (-12, -235), (-11, -215)]
[(-10, -195), (-9, -175), (-8, -155), (-7, -135), (-6, -115)]
[(-5, -95), (-4, -75), (-3, -55), (-2, -35), (-1, -15)]
[(0, 5), (1, 25), (2, 45), (3, 65), (4, 85)]
[(5, 105), (6, 125), (7, 145), (8, 165), (9, 185)]
[(10, 205), (11, 225), (12, 245), (13, 265), (14, 285)]
[(15, 305), (16, 325), (17, 345), (18, 365), (19, 385)]
[(20, 405), (21, 425), (22, 445), (23, 465), (24, 485)]
[(25, 505), (26, 525), (27, 545), (28, 565), (29, 585)]
[(30, 605), (31, 625), (32, 645), (33, 665), (34, 685)]
[(35, 705), (36, 725), (37, 745), (38, 765), (39, 785)]
[(40, 805), (41, 825), (42, 845), (43, 865), (44, 885)]
[(45, 905), (46, 925), (47, 945), (48, 965), (49, 985)]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(45, 905), (46, 925), (47, 945), (48, 965), (49, 985)]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">vector_mean</span><span class="p">([</span><span class="n">linear_gradient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[-93150.48112529561, -1980.142091882065]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered celltag_outputPrepend">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">minibatches</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="n">vector_mean</span><span class="p">([</span><span class="n">linear_gradient</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">batch</span><span class="p">])</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">gradient_step</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="o">-</span><span class="n">learning_rate</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0174439, 4.987695719934339]
542 [19.999981615582296, 4.9877593372925615]
543 [20.000000596031473, 4.988289930402195]
544 [19.99986600291718, 4.9883239135764414]
545 [19.99499138463032, 4.988639932226969]
546 [19.999106275087044, 4.9889237404077695]
547 [19.999498300298526, 4.988854260750452]
548 [20.000271229385476, 4.988978006337807]
549 [20.000789860846815, 4.989009143704562]
550 [20.004410855748826, 4.989321208985817]
551 [20.001955283508405, 4.99015464962172]
552 [20.0001065591595, 4.990301335875948]
553 [19.999684782625707, 4.990416463383617]
554 [19.998480665319182, 4.990629232891488]
555 [19.999335716817637, 4.990639007902794]
556 [20.000209184834983, 4.990763925347079]
557 [20.00033959027654, 4.99081923331454]
558 [19.999487304052245, 4.990849736132178]
559 [20.00058632993606, 4.990893751553599]
560 [19.9996341266611, 4.9908995554867275]
561 [19.999047782377176, 4.990976456020754]
562 [19.999816091389658, 4.990944596978783]
563 [19.997947199881725, 4.991045100709673]
564 [20.003431678142867, 4.991190192449931]
565 [20.00084990238428, 4.991166237743064]
566 [20.00035964318308, 4.991785466273858]
567 [20.00135173131417, 4.991982446999655]
568 [20.000194846304225, 4.992027832044395]
569 [20.000506159346322, 4.9920845236304725]
570 [20.000308784817037, 4.992532629953334]
571 [20.00122398606343, 4.99270512275545]
572 [20.001577771335157, 4.992739537473374]
573 [20.001256023288832, 4.99309610590892]
574 [20.00006607530469, 4.9931921371564965]
575 [20.000011037618915, 4.993233598258538]
576 [19.999712342029238, 4.993534697593086]
577 [20.000419952043295, 4.993564673910611]
578 [19.999748257632902, 4.993855698955353]
579 [19.99968326243102, 4.993891145294629]
580 [19.999770973525084, 4.9939187173679755]
581 [19.99977960668069, 4.993955026753492]
582 [20.000199244035738, 4.994020035010551]
583 [19.99867142331284, 4.9940987490233315]
584 [20.00081798891305, 4.9939921214020275]
585 [19.9974886743812, 4.994125472267269]
586 [20.00003190636478, 4.9931439274303075]
587 [19.998370035985598, 4.993227706733621]
588 [20.00006094266822, 4.993377026515803]
589 [20.00107458792351, 4.993498538061179]
590 [20.00054004467948, 4.9935042028192]
591 [20.000068467673117, 4.993535897792969]
592 [19.99938627625401, 4.993600658968873]
593 [20.001244698271453, 4.993689735897718]
594 [19.99978400767608, 4.993656988953965]
595 [20.000090463563087, 4.993692612719484]
596 [20.000227581435944, 4.993740988124777]
597 [19.999774074328815, 4.994014093407413]
598 [20.000351389852987, 4.994067138247735]
599 [20.00004048482383, 4.994350454505409]
600 [19.999115807026705, 4.994440003951634]
601 [19.99960820570278, 4.994447635410569]
602 [20.002134881781053, 4.9945803379230735]
603 [19.99995561294707, 4.994815735197597]
604 [20.000011191935975, 4.994848047454656]
605 [20.00018180238492, 4.994994352691944]
606 [20.000035132604985, 4.995023050337098]
607 [20.00006052992044, 4.995053476354333]
608 [19.999803526484637, 4.995155692493837]
609 [19.99992567433003, 4.995157721419921]
610 [19.99782758680514, 4.9952911717645305]
611 [19.99968602285902, 4.996320614686565]
612 [19.999761203439018, 4.996328573517238]
613 [20.000584197134067, 4.99635365979857]
614 [20.000780955989516, 4.996369855515448]
615 [19.999698773520144, 4.996430998523762]
616 [20.000520799415828, 4.996445433568358]
617 [20.00004123441158, 4.996620163985945]
618 [20.000016558511135, 4.996640508570653]
619 [20.000129828855997, 4.996672684270863]
620 [20.000169645621188, 4.996691228265987]
621 [19.999876237855627, 4.9967081983310235]
622 [19.999994200549455, 4.996851843742128]
623 [20.000146303079223, 4.996863037341749]
624 [19.99987767480813, 4.997002706347402]
625 [19.99987069339498, 4.997132806425987]
626 [19.9998761426825, 4.997257207498004]
627 [19.999888350445378, 4.997260659246382]
628 [20.000437278198795, 4.997290301648176]
629 [19.999920534393812, 4.997179342531964]
630 [20.00054803833582, 4.997211366883741]
631 [20.0001698860339, 4.997246102035671]
632 [19.999368092960818, 4.9972871929363345]
633 [20.00103899337845, 4.997330741126046]
634 [19.999984761725074, 4.997597848586266]
635 [20.00016822507893, 4.997605977231071]
636 [19.99963118632392, 4.9976195555928955]
637 [19.99895794221465, 4.997695940932176]
638 [19.999955517229786, 4.9977762894283675]
639 [20.0001485787874, 4.997785779376653]
640 [20.00007376899375, 4.997793894704042]
641 [19.999981905909756, 4.997804998442234]
642 [19.999870321062705, 4.997811561611201]
643 [19.999903600879236, 4.997918813385269]
644 [20.00082915028864, 4.997968136790085]
645 [20.00020751023985, 4.997961996835166]
646 [19.999990414675356, 4.997980017178859]
647 [19.999682639996355, 4.99801585001645]
648 [20.000050112040878, 4.997934054905481]
649 [20.000831821432463, 4.99798891539446]
650 [20.000206249755422, 4.9979825279172365]
651 [19.999917006263754, 4.997980876537317]
652 [20.00002410706041, 4.997994556436804]
653 [20.000002214100356, 4.99808255037586]
654 [20.000021076116806, 4.998093981899837]
655 [20.00002055553696, 4.99810560250891]
656 [19.999816560631732, 4.998124566795015]
657 [19.999984642461985, 4.998200198482651]
658 [19.99981616359544, 4.998217229055613]
659 [20.000035393065048, 4.998243903287662]
660 [19.9992030120956, 4.998291001408482]
661 [20.000616227802677, 4.998304287372548]
662 [20.00008939766132, 4.998278954234074]
663 [19.99992562351974, 4.998281564823677]
664 [19.999920912081887, 4.99835799183276]
665 [19.99960226666203, 4.99837470575552]
666 [20.00002386549488, 4.998472401345437]
667 [19.999943004029163, 4.998496476719925]
668 [19.99976079426524, 4.998531063983669]
669 [20.000084317128028, 4.998539854222635]
670 [20.000615923776664, 4.998581733618633]
671 [20.000629861739597, 4.998644160475567]
672 [20.000048536156214, 4.99864528560314]
673 [19.99978965796439, 4.998661435316797]
674 [19.99998794271521, 4.998672091557781]
675 [20.000552785672216, 4.998706567512049]
676 [19.999992372412205, 4.99876261816334]
677 [20.00005711484584, 4.998766777844965]
678 [20.000004662006507, 4.998822548551631]
679 [20.000236869846475, 4.99883481298948]
680 [20.000196729558994, 4.998891763600326]
681 [20.000234269364373, 4.998895541308272]
682 [19.99996517106542, 4.998889672560028]
683 [19.999998584337153, 4.998938430099211]
684 [20.000074746716834, 4.998941944485706]
685 [19.999837020048112, 4.99894788084659]
686 [20.00002679989159, 4.998903346842459]
687 [20.00003222102956, 4.9989106215297765]
688 [20.00000788129079, 4.998916771162987]
689 [20.000175647891094, 4.9989363367320765]
690 [19.999765242686173, 4.99895637345829]
691 [20.00004622120069, 4.998971121162959]
692 [19.99975891118108, 4.998985294624995]
693 [19.99999197880521, 4.998992485826579]
694 [19.999841274957575, 4.999011127772183]
695 [20.0001403897637, 4.9990033013508155]
696 [19.999998253925554, 4.999014435896701]
697 [20.000034264016293, 4.999040288184218]
698 [19.999955877402698, 4.999042439748322]
699 [20.00018825848265, 4.9990543639005525]
700 [20.000201592263497, 4.999056799659069]
701 [20.00005492575297, 4.999069795400561]
702 [20.000391029488203, 4.999096417809743]
703 [20.000039245286683, 4.999099850414286]
704 [20.000359718741173, 4.999124378364134]
705 [20.000040525427277, 4.9991032696577244]
706 [19.999915590023086, 4.9991132713932585]
707 [19.99995419338583, 4.99915353933826]
708 [20.000035607526737, 4.999154602328677]
709 [19.99995311679038, 4.999157460779425]
710 [19.99998681354621, 4.999157154159839]
711 [20.00005837170796, 4.999160163048494]
712 [20.00004408145303, 4.999165992055111]
713 [20.000167659580978, 4.999172850770625]
714 [20.000022163647174, 4.999177831544556]
715 [20.000049508128576, 4.999183844106814]
716 [20.00005126078365, 4.9991890562009536]
717 [19.999875383780967, 4.999194704572094]
718 [20.00002845572942, 4.999192043165977]
719 [19.999966497030126, 4.999228609985814]
720 [19.99999781664758, 4.999260980050043]
721 [19.999663546424262, 4.999281344739139]
722 [19.99999926332784, 4.99935647536214]
723 [20.000024794999785, 4.999363226211717]
724 [20.000004399433525, 4.9993668897381545]
725 [19.999906636403463, 4.999376932478269]
726 [19.999993540620267, 4.999381876760677]
727 [20.00000625508363, 4.999385597859263]
728 [19.9998532649484, 4.999393251864716]
729 [19.99996427237313, 4.999367447749623]
730 [19.99972691301617, 4.999385564891005]
731 [20.000019750009137, 4.999398143175085]
732 [20.000024655726556, 4.999400536648848]
733 [20.000002023658716, 4.999427524547207]
734 [19.999871374625396, 4.99943440372621]
735 [20.000010921414848, 4.999466214047424]
736 [20.000086884599597, 4.999476882817193]
737 [20.000011737317493, 4.999479749199932]
738 [19.99991898282803, 4.999486725761123]
739 [19.999942326105018, 4.999488915975406]
740 [20.000079693162796, 4.999488930001833]
741 [20.000080956969374, 4.999510296716763]
742 [19.9999879773395, 4.99953432839747]
743 [19.999799834462166, 4.999547165863222]
744 [20.000075131763417, 4.999558938833413]
745 [20.000035849750013, 4.999559556508258]
746 [19.999898157986205, 4.999566244536701]
747 [20.00000024905577, 4.999569455113387]
748 [20.000069664925256, 4.99957680547498]
749 [20.00000642161465, 4.999578590688852]
750 [19.999986445998665, 4.999583802771318]
751 [20.000014785415313, 4.999590923140461]
752 [20.00000122176486, 4.999609259757014]
753 [20.000063504545974, 4.999616126556052]
754 [20.000000040833907, 4.9996209779261545]
755 [19.99998521834417, 4.9996309355418305]
756 [19.999999218549977, 4.9996333955869865]
757 [19.999987703040617, 4.999637184257707]
758 [19.999982125503234, 4.999639105533368]
759 [19.999977113112493, 4.999639882198479]
760 [19.999963710408576, 4.999642603270997]
761 [19.99997606276913, 4.999643566985105]
762 [19.999977048107457, 4.999644578335405]
763 [20.000020690251805, 4.999647997433418]
764 [19.999987510851387, 4.99964863673567]
765 [19.999978452760892, 4.999649512399699]
766 [19.999838624914744, 4.999659875346735]
767 [20.000007369664672, 4.999667053074765]
768 [19.999996428006334, 4.9996684138729535]
769 [20.000005248305264, 4.999669755202231]
770 [19.999948460369566, 4.9996745329433]
771 [19.999983743134983, 4.999703532932974]
772 [20.000003699667598, 4.999705581276127]
773 [20.000011679442206, 4.9997078760939955]
774 [19.99998717732398, 4.999708399366872]
775 [19.999969402129786, 4.999710828316429]
776 [20.00000854288812, 4.999719695859449]
777 [20.00000421451076, 4.9997200389429794]
778 [20.000004537313572, 4.999720861350716]
779 [20.000019419979058, 4.999721900153342]
780 [20.00005747031053, 4.999724096440061]
781 [20.00001437522573, 4.999715380078249]
782 [19.999932995576774, 4.999719349176173]
783 [19.99986778210168, 4.9997293963329765]
784 [19.999997326041623, 4.999740374315237]
785 [20.000000526586508, 4.999741997745439]
786 [19.999984727877337, 4.999742802992769]
787 [19.99998876631666, 4.999742262792785]
788 [19.99998881964764, 4.999753531029616]
789 [19.999940358015518, 4.9997560665203595]
790 [20.00003356691736, 4.9997509166884475]
791 [20.000020178007983, 4.999752058581226]
792 [19.999888413145396, 4.999758224438631]
793 [19.999983056219843, 4.999749392179478]
794 [19.99995982894574, 4.999756335527912]
795 [19.999985244193685, 4.9997591298909825]
796 [20.000007981731866, 4.999764638867979]
797 [19.999893383870926, 4.999770847987411]
798 [19.99999463920032, 4.999772364390862]
799 [19.99999201841534, 4.999774051464918]
800 [20.000012523931144, 4.999776090869811]
801 [19.999904876393654, 4.999781622569841]
802 [20.000006129803534, 4.999786003405126]
803 [19.999990844870638, 4.999786496289744]
804 [19.999999754218877, 4.999795771535905]
805 [20.00008543588657, 4.999801138843467]
806 [19.999996553205374, 4.99979798112186]
807 [19.999969575510995, 4.99980195741197]
808 [19.999995434422782, 4.9998007474824195]
809 [19.999990301349133, 4.999801685807988]
810 [19.999991521901798, 4.9998103484934076]
811 [19.99999189432545, 4.999818581859228]
812 [19.999988782750325, 4.999819053400415]
813 [20.000028819765905, 4.999820376733989]
814 [20.00000521988605, 4.999818947335353]
815 [20.000013162943468, 4.999819466767467]
816 [19.99999218844099, 4.999819562491116]
817 [20.000071164034154, 4.999823844420754]
818 [20.000017445683543, 4.9998234711659615]
819 [19.999925805657263, 4.999827620490646]
820 [19.99997392560816, 4.999826968835137]
821 [19.999991126760865, 4.999823085812404]
822 [19.99999933685806, 4.999830416615327]
823 [20.00000042538475, 4.999831464412099]
824 [19.999992469129367, 4.999832057762478]
825 [20.000004147617098, 4.9998338315435005]
826 [20.00002708569316, 4.9998372647092815]
827 [20.00000218033654, 4.999837960816148]
828 [20.000003118864758, 4.999838987768075]
829 [20.000032531590275, 4.999840593373803]
830 [20.00000886080678, 4.999835832854577]
831 [19.99999104282453, 4.999836410212736]
832 [20.000004660213637, 4.999836826448525]
833 [19.99999493647252, 4.999838856251168]
834 [19.999993137620834, 4.999845217762383]
835 [19.999993320801128, 4.999851886532083]
836 [19.99999939743016, 4.999858192526396]
837 [19.999999875826283, 4.999864477023379]
838 [20.00000787030473, 4.999865572001848]
839 [20.000008421255504, 4.999866438293126]
840 [19.999979474740588, 4.999867371959443]
841 [20.000003391912447, 4.999862197920296]
842 [20.000005049112627, 4.999867523676116]
843 [19.99999599708269, 4.999869287882812]
844 [19.99994402391314, 4.999872953711209]
845 [19.999994409759655, 4.999870072645881]
846 [19.99999963636949, 4.999875526879407]
847 [20.000008740519572, 4.999875951084639]
848 [19.999972591554265, 4.999877745735423]
849 [19.99999063243271, 4.999877744007692]
850 [19.999999289211125, 4.999882682929672]
851 [20.00000008246688, 4.999887965941229]
852 [19.999989276314498, 4.9998890516918335]
853 [19.99999541415068, 4.999889044008612]
854 [20.000000130671648, 4.9998898372366325]
855 [20.000004230051037, 4.999890995486706]
856 [19.999974230659117, 4.999892468533209]
857 [19.999985363603148, 4.999892746637865]
858 [19.999987965400976, 4.9998933229584415]
859 [20.00001663429543, 4.999893326410295]
860 [20.000042476277304, 4.999896860380098]
861 [20.00000617384677, 4.999895047866241]
862 [20.000005502162225, 4.99989572970905]
863 [19.999996262870102, 4.999896180313144]
864 [19.999996387681023, 4.99989681180753]
865 [20.000003397266983, 4.999898054750802]
866 [20.000001434263993, 4.999898684028179]
867 [20.000000615549162, 4.9998992730033045]
868 [20.00000659380302, 4.999899599689038]
869 [20.00001945444218, 4.99990042518293]
870 [20.000005423839553, 4.9998978304381]
871 [19.999976481893185, 4.999899321633255]
872 [19.99999968785077, 4.999901311295792]
873 [20.000041117452444, 4.999903896287959]
874 [20.000004572229777, 4.999901467668209]
875 [19.999955442012205, 4.99990402784533]
876 [19.999956347032356, 4.99990817901571]
877 [20.000003109098994, 4.999910159175416]
878 [19.999999271067296, 4.999910617496066]
879 [19.99999631668169, 4.999913275919286]
880 [20.000005059375706, 4.999914055979269]
881 [19.99999651236745, 4.999914132864609]
882 [20.000002521201093, 4.999914903786156]
883 [20.000000528371967, 4.999915401253217]
884 [19.99999643399197, 4.999919166040321]
885 [19.999980447887335, 4.9999200014946545]
886 [19.99999884897347, 4.999920687362414]
887 [20.00000271905049, 4.9999223352884075]
888 [19.999995801151595, 4.999922579829803]
889 [19.99999873213879, 4.999922552207603]
890 [19.99998171737115, 4.999923478919341]
891 [20.00001289832371, 4.999925000780635]
892 [20.00001613640959, 4.999925300163064]
893 [20.000000293661163, 4.999926469701369]
894 [20.000001261531498, 4.999926687425395]
895 [19.999992937619513, 4.999927436846206]
896 [20.00000187603356, 4.999926215589401]
897 [20.00000534521645, 4.999926430951541]
898 [19.9999976112419, 4.999928589601024]
899 [19.999996484187037, 4.999928966254621]
900 [19.999995495423615, 4.999929119152602]
901 [19.999996355129774, 4.999929594216124]
902 [19.99999693328312, 4.999932856983116]
903 [20.000004503057916, 4.999933501950981]
904 [19.999990402266466, 4.9999339030453775]
905 [20.000001755334793, 4.999936468812181]
906 [20.000026685716477, 4.999938213070211]
907 [19.9999985125771, 4.999938708710521]
908 [20.000001589585505, 4.99993930473889]
909 [19.99999055925613, 4.999940083743619]
910 [19.999999273157652, 4.99994231389253]
911 [19.999999708913403, 4.999942450317215]
912 [19.999999945968444, 4.9999449987679405]
913 [20.0000088920561, 4.999945921493]
914 [19.99999822126521, 4.999945703814369]
915 [19.99999669169406, 4.999945851883295]
916 [20.000003081279715, 4.999946367321047]
917 [20.0000088355776, 4.99994773386018]
918 [19.999995473241135, 4.99994853297641]
919 [19.999977778726674, 4.999950079854233]
920 [20.000018694448336, 4.999950457559163]
921 [19.999990336902083, 4.999951760591991]
922 [19.999999218482454, 4.999953495126958]
923 [19.999997774958306, 4.999953707337823]
924 [20.00000050873713, 4.999954016582335]
925 [20.000001800522842, 4.999954400335169]
926 [20.000000316920143, 4.999954662433736]
927 [19.99999290395336, 4.9999553823311]
928 [19.999992641403846, 4.999957265270115]
929 [20.00000015214722, 4.999957886509864]
930 [20.000002672236803, 4.999958220433263]
931 [19.999993581397288, 4.99995850647356]
932 [19.99999997003, 4.999958786258031]
933 [19.999998060599406, 4.999958941348206]
934 [19.999999855455485, 4.999960647404849]
935 [20.000000157816174, 4.9999609017145135]
936 [19.999998416496343, 4.999961887227885]
937 [19.999998190952557, 4.999963615592328]
938 [20.000002425825713, 4.9999637612580266]
939 [20.00000259431221, 4.999963987789751]
940 [19.99999675481634, 4.999964422074914]
941 [19.99999816732454, 4.9999647027642595]
942 [20.000000840702533, 4.999965126338165]
943 [19.999984437979858, 4.999966039450292]
944 [19.99999054474163, 4.999965875687847]
945 [19.99998414861412, 4.999967127604746]
946 [19.999997702568823, 4.999974170226706]
947 [19.99999831178717, 4.999974218810738]
948 [19.9999995558857, 4.999974193167806]
949 [20.000010326559792, 4.999974835170986]
950 [19.99998912881101, 4.999975161781803]
951 [19.999999471877583, 4.9999753445831026]
952 [20.000001478330496, 4.999975551741499]
953 [20.00000014429321, 4.999976724612936]
954 [19.99999915357676, 4.999977040413208]
955 [20.000000573556715, 4.9999772915302]
956 [19.99999464099966, 4.999977587098765]
957 [20.000000968210067, 4.999977912753564]
958 [20.000000160729638, 4.999978038750654]
959 [20.000003489933086, 4.999978437016861]
960 [19.99999677669304, 4.999978238685441]
961 [19.999996576342358, 4.999979128238643]
962 [20.000000453495776, 4.999978143359864]
963 [19.999999944478443, 4.999978238307126]
964 [20.000000820215476, 4.999978482419291]
965 [20.00000868161401, 4.999979065877949]
966 [20.000001266922986, 4.999983331988109]
967 [19.999999463540885, 4.999983834368562]
968 [20.000000028942605, 4.999983947536093]
969 [20.000000991203805, 4.999984071917463]
970 [19.999997696571107, 4.9999841821297695]
971 [19.999992659010772, 4.999984689942417]
972 [19.999997956643792, 4.999984594133582]
973 [20.000000507977635, 4.999984555583047]
974 [20.000000747395298, 4.99998464024566]
975 [19.999999891677923, 4.999984731220575]
976 [20.000000000086033, 4.999985393550547]
977 [20.000000553634464, 4.999985549912029]
978 [20.00000093288263, 4.9999856470264294]
979 [20.000000226638683, 4.999985728004471]
980 [20.000000559795335, 4.99998583537648]
981 [20.000000113062736, 4.999985913801098]
982 [20.00000087654127, 4.9999860204792785]
983 [19.999996928788473, 4.999986220301828]
984 [20.000002535685912, 4.999986473169826]
985 [20.000000629083907, 4.9999879197770225]
986 [20.000000186976333, 4.999987994142546]
987 [20.000000474606708, 4.999988083461436]
988 [20.000001815792686, 4.999988364266029]
989 [19.99999963565403, 4.999987969900192]
990 [20.000000754239146, 4.9999880162060695]
991 [20.00000063183847, 4.999988096359218]
992 [20.00000008084366, 4.9999881620170035]
993 [19.999998254201415, 4.999988350026871]
994 [19.99999723176732, 4.999988421236446]
995 [20.00000209059704, 4.999988650124481]
996 [19.999999787375447, 4.99998896007045]
997 [20.00000033873479, 4.999989166488239]
998 [19.9999996289877, 4.999989378569714]
999 [19.999998311807346, 4.99998961815273]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[19.999998311807346, 4.99998961815273]</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/2020/10/21/gradient-descent-minibatch.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>This is not another blog about bitcoin.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/nocibambi" title="nocibambi"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
